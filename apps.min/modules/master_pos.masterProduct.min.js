/**
 * Filename: master_pos.masterProduct.js
 * Generated 2017-09-14 at 09:14:22 PM
 */
Ext.define('ExtApp.modules.master_pos.model.model_masterProduct',{extend:'Ext.data.Model',alias:'model_masterProduct',fields:[{name:'id',type:'int'},{name:'product_name',type:'string'},{name:'product_name_show',type:'string'},{name:'product_chinese_name',type:'string'},{name:'product_desc',type:'string'},{name:'normal_price',type:'string'},{name:'normal_price_show',type:'string'},{name:'product_price',type:'string'},{name:'product_price_show',type:'string'},{name:'product_hpp',type:'string'},{name:'category_id',type:'int'},{name:'product_category_name',type:'string'},{name:'product_group',type:'string'},{name:'product_type',type:'string'},{name:'product_image',type:'string'},{name:'product_image_show',type:'string'},{name:'product_image_src',type:'string'},{name:'has_varian',type:'int'},{name:'hide_compliment_order',type:'int'},{name:'use_tax',type:'int'},{name:'use_service',type:'int'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'supplier_id',type:'int'},{name:'is_kerjasama',type:'int'},{name:'is_kerjasama_text',type:'string'},{name:'persentase_bagi_hasil',type:'string'},{name:'total_bagi_hasil',type:'string'},{name:'total_bagi_hasil_show',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterProduct/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterProductPackage',{extend:'Ext.data.Model',alias:'model_masterProductPackage',fields:[{name:'id',type:'int'},{name:'product_id',type:'int'},{name:'product_name',type:'string'},{name:'product_desc',type:'string'},{name:'product_price',type:'string'},{name:'product_hpp',type:'string'},{name:'category_id',type:'int'},{name:'product_category_name',type:'string'},{name:'product_type',type:'string'},{name:'product_image',type:'string'},{name:'product_image_show',type:'string'},{name:'product_image_src',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterProductPackage/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterProductGramasi',{extend:'Ext.data.Model',alias:'model_masterProductGramasi',fields:[{name:'id',type:'int'},{name:'product_id',type:'int'},{name:'item_id',type:'int'},{name:'item_name',type:'string'},{name:'item_category_id',type:'int'},{name:'item_category_name',type:'string'},{name:'item_price_acuan',type:'string'},{name:'item_price',type:'string'},{name:'item_qty',type:'string'},{name:'unit_id',type:'int'},{name:'unit_name',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterProductGramasi/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_productCategory',{extend:'Ext.data.Model',alias:'model_productCategory',fields:[{name:'id',type:'int'},{name:'parent_id',type:'int'},{name:'product_category_name',type:'string'},{name:'product_category_desc',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/productCategory/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_itemCategory',{extend:'Ext.data.Model',alias:'model_itemCategory',fields:[{name:'id',type:'int'},{name:'item_category_name',type:'string'},{name:'item_category_code',type:'string'},{name:'item_category_desc',type:'string'},{name:'item_category_code_name',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/itemCategory/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.model.model_masterItem',{extend:'Ext.data.Model',alias:'model_masterItem',fields:[{name:'id',type:'int'},{name:'item_code',type:'string'},{name:'item_name',type:'string'},{name:'item_desc',type:'string'},{name:'item_manufacturer',type:'string'},{name:'sales_price',type:'string'},{name:'sales_price_show',type:'string'},{name:'item_price',type:'string'},{name:'item_price_show',type:'string'},{name:'item_hpp',type:'string'},{name:'item_hpp_show',type:'string'},{name:'last_in',type:'string'},{name:'last_in_show',type:'string'},{name:'total_qty_stok',type:'string'},{name:'item_type',type:'string'},{name:'item_type_name',type:'string'},{name:'item_image',type:'string'},{name:'item_image_show',type:'string'},{name:'item_image_src',type:'string'},{name:'category_id',type:'int'},{name:'item_category_name',type:'string'},{name:'item_category_code',type:'string'},{name:'subcategory_id',type:'int'},{name:'item_subcategory_name',type:'string'},{name:'item_subcategory_code',type:'string'},{name:'unit_id',type:'int'},{name:'unit_name',type:'string'},{name:'unit_code',type:'string'},{name:'supplier_id',type:'int'},{name:'supplier_name',type:'string'},{name:'is_active',type:'int'},{name:'is_active_text',type:'string'},{name:'use_for_sales',type:'int'},{name:'use_for_sales_text',type:'string'},{name:'id_ref_menu',type:'int'},{name:'sales_use_tax',type:'int'},{name:'sales_use_tax_text',type:'string'},{name:'sales_use_service',type:'int'},{name:'sales_use_service_text',type:'string'},{name:'is_kerjasama',type:'int'},{name:'is_kerjasama_text',type:'string'},{name:'persentase_bagi_hasil',type:'string'},{name:'total_bagi_hasil',type:'string'},{name:'total_bagi_hasil_show',type:'string'},{name:'use_stok_kode_unik',type:'int'},{name:'use_stok_kode_unik_text',type:'string'}],proxy:{type:'ajax',url:appUrl+'master_pos/masterItem/gridData',extraParams:{},actionMethods:{read:'POST'},reader:{type:'json',root:'data',idProperty:'id',totalProperty:'totalCount'}}});Ext.define('ExtApp.modules.master_pos.store.store_masterProduct',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterProduct',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterProductPackage',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterProductPackage',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterProductGramasi',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterProductGramasi',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_productCategory',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_productCategory',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_masterItem',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_masterItem',autoLoad:false,remoteSort:true});Ext.define('ExtApp.modules.master_pos.store.store_itemCategory',{extend:'Ext.data.Store',model:'ExtApp.modules.master_pos.model.model_itemCategory',autoLoad:false,remoteSort:true});Ext.define("ExtApp.modules.master_pos.view.masterProduct",{openWindow:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var phpJs=me.app.getHelper('phpJs');var add_parameter='_dc='+phpJs.mktime();add_parameter+='&module=master_pos';add_parameter+='&file=masterProduct';add_parameter+='&action=print_masterProduct';var url_report='';me.store_masterProduct_masterProduct=theApp.getStore('store_masterProduct_masterProduct',false);if(me.store_masterProduct_masterProduct==false){me.store_masterProduct_masterProduct=theApp.copyStore('master_pos','store_masterProduct','store_masterProduct_masterProduct');}
me.store_masterProduct_masterProduct.proxy.extraParams.limit=25;me.store_masterProduct_masterProduct.proxy.extraParams.show_all_text=0;me.store_masterProduct_masterProduct.proxy.extraParams.show_choose_text=0;me.store_masterProduct_masterProduct.proxy.extraParams.is_dropdown=0;me.store_masterProduct_masterProduct.proxy.extraParams.keywords='';var helperGrid=theApp.getHelper('Grid');var selModel_masterProduct=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_masterProduct').down('#deleteButton_masterProduct').setDisabled(selections.length==0);}}});var store_product_active=new Ext.data.Store({fields:['val','name'],data:[{"val":"","name":"All"},{"val":"1","name":"Active"},{"val":"0","name":"Not Active"}],autoLoad:true});return desktop.createWindow({id:me.id,title:'Master Menu & Package',width:900,height:580,iconCls:'icon-grid',animCollapse:false,constrainHeader:true,resizable:true,maximized:false,border:0,layout:{type:'border'},items:[{xtype:'form',title:'Filter',width:330,region:'west',id:'form_filter_masterProduct',split:true,collapsible:true,splitterResize:false,collapseMode:'mini',animCollapse:true,scroll:false,bodyPadding:10,margin:'0 0 0 0',items:[{xtype:'textfield',name:'keywords',id:'filter_keywords_masterProduct',width:200,labelSeparator:'',emptyText:'Keywords: Name / Category',anchor:'100%',listeners:{specialkey:function(field,e){if(e.getKey()==e.ENTER){me.search_masterProduct();}}}},{xtype:'combobox',name:'is_active',fieldLabel:'Active/Not Active ',emptyText:'All',labelWidth:120,id:'filter_is_active_masterProduct',anchor:'70%',store:store_product_active,queryMode:'local',hiddenName:"val",displayField:'name',valueField:'val',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false},{xtype:'container',style:'text-align:right',border:0,items:[{xtype:'button',text:'Search',scale:'medium',margin:'15 0 0 0',itemId:'btnFilterSearch_masterProduct',tooltip:'Search',iconCls:'btn-search',handler:function(){me.search_masterProduct();}},{xtype:'button',text:'Reset',scale:'medium',margin:'15 60 0 10',itemId:'btnResetFilterSearch_masterProduct',tooltip:'Reset',iconCls:'btn-reset',handler:function(){me.search_masterProduct(true);}}]}]},{xtype:'gridpanel',margins:'0 0 0 0',region:'center',store:me.store_masterProduct_masterProduct,id:'grid_masterProduct',scroll:true,selModel:selModel_masterProduct,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'product_name',text:'Name',width:150},{xtype:'gridcolumn',dataIndex:'product_category_name',text:'Category',width:150},{xtype:'gridcolumn',dataIndex:'normal_price_show',text:'Normal Price',width:150},{xtype:'gridcolumn',dataIndex:'product_price_show',text:'Current Price',width:150},{xtype:'gridcolumn',dataIndex:'product_hpp',text:'HPP',width:100},{xtype:'gridcolumn',dataIndex:'product_image_show',text:'Image',width:120},{xtype:'gridcolumn',dataIndex:'product_desc',text:'Description',width:200},{xtype:'gridcolumn',dataIndex:'is_active_text',text:'Status Active',width:100}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_masterProduct').getSelectionModel().selected;if(getSelection.length>0){me.formType='edit';me.edit_data=rec.data;me.createWindow(me,'add_masterProduct');}}},bbar:helperGrid.paging({ds:me.store_masterProduct_masterProduct,title:'Product'}),dockedItems:[{xtype:'toolbar',dock:'top',items:[{text:'Filter',itemId:'filterButton_masterProduct',tooltip:'Filter Product',iconCls:'btn-search',listeners:{click:function(){Ext.getCmp('form_filter_masterProduct').toggleCollapse();}}},'->',{text:'Download',itemId:'Button_downloadMasterProduct',tooltip:'Download format Product/Menu',iconCls:'icon-download',handler:function(){me.download_masterProductExcel(true);}},'-',{text:'Upload',itemId:'Button_uploadMasterProduct',tooltip:'Upload format Product/Menu',iconCls:'btn-add',handler:function(){me.formType='add';me.createWindow(me,'add_uploadMasterProduct');}},'-',{text:'Add',itemId:'addButton_masterProduct',tooltip:'Add Product',iconCls:'btn-add',handler:function(){me.formType='add';me.createWindow(me,'add_masterProduct');}},'-',{text:'Delete',itemId:'deleteButton_masterProduct',tooltip:'Delete Product',iconCls:'btn-delete',disabled:true,handler:function(){var getSelection=Ext.getCmp('grid_masterProduct').getSelectionModel().selected;if(getSelection.length>0){me.delete_data=getSelection.items[0].data;me.deleteConfirm_masterProduct();}else{ExtApp.Msg.info('Please Select Product!');}}},'-',{text:'Refresh',itemId:'refreshButton_masterProduct',tooltip:'Refresh Product',iconCls:'btn-refresh',handler:function(){Ext.getCmp('grid_masterProduct').store.load();}}]}]},{xtype:"component",id:'print_area_masterProduct',autoEl:{tag:"iframe",src:url_report},border:false,hidden:true}],listeners:{boxready:function(){Ext.getCmp('form_filter_masterProduct').toggleCollapse();me.search_masterProduct(true);},show:function(){}}});},add_masterProduct:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Add New ';if(me.formType=='edit'){Titletext='Update ';}
var store_product_type=new Ext.data.Store({fields:['val','name'],data:[{"val":"item","name":"Item"},{"val":"package","name":"Package"}],autoLoad:true});var helperGrid=theApp.getHelper('Grid');var selModel_masterProductPackage=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_masterProductPackage').down('#deleteButton_masterProductPackage').setDisabled(selections.length==0);}}});var store_masterProductPackage=theApp.getStore('store_masterProductPackage',false);if(store_masterProductPackage==false){store_masterProductPackage=theApp.copyStore('master_pos','store_masterProductPackage','store_masterProductPackage');}
store_masterProductPackage.proxy.extraParams.limit=9999;var store_ComboboxProductCategory=theApp.getStore('store_ComboboxProductCategory',false);if(store_ComboboxProductCategory==false){store_ComboboxProductCategory=theApp.copyStore('master_pos','store_productCategory','store_ComboboxProductCategory');}
store_ComboboxProductCategory.proxy.extraParams.limit=9999;var selModel_masterProductGramasi=Ext.create('Ext.selection.CheckboxModel',{listeners:{selectionchange:function(sm,selections){Ext.getCmp('grid_masterProductGramasi').down('#deleteButton_masterProductGramasi').setDisabled(selections.length==0);}}});var store_masterProductGramasi_masterProduct=theApp.getStore('store_masterProductGramasi_masterProduct',false);if(store_masterProductGramasi_masterProduct==false){store_masterProductGramasi_masterProduct=theApp.copyStore('master_pos','store_masterProductGramasi','store_masterProductGramasi_masterProduct');}
store_masterProductGramasi_masterProduct.proxy.extraParams.limit=9999;return desktop.createWindow({id:me.id+'_add_masterProduct',title:Titletext,width:700,height:500,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:{xtype:'tabpanel',minHeight:490,activeTab:0,border:false,defaults:{bodyPadding:'10 10 10 10',layout:'fit'},items:[{title:'Product Info',layout:'fit',items:[{xtype:'form',id:'form_masterProduct',border:0,layout:{type:'border'},items:[{xtype:'panel',flex:1,region:'center',layout:{type:'auto'},border:0,bodyPadding:10,margin:'0 5 0 0',defaults:{margin:'5 0 0 0',width:300},items:[{xtype:'hidden',name:'form_type_masterProduct',value:me.formType},{xtype:'hidden',name:'id'},{xtype:'hidden',name:'product_image'},{xtype:'hidden',name:'old_product_type'},{xtype:'textfield',name:'product_name',fieldLabel:'Name',anchor:'100%',allowBlank:false},{xtype:'radiogroup',fieldLabel:'Group',id:'product_group_masterProduct',columns:3,vertical:true,allowBlank:false,items:[{boxLabel:'Food',id:'product_group_Food_masterProduct',name:'product_group',inputValue:'food',checked:true,width:60},{boxLabel:'Beverage',id:'product_group_Beverage_masterProduct',name:'product_group',inputValue:'beverage',width:80},{boxLabel:'Other',id:'product_group_Other_masterProduct',name:'product_group',inputValue:'other',width:80}]},{xtype:'combobox',name:'product_type',fieldLabel:'Type',anchor:'100%',store:store_product_type,queryMode:'local',hiddenName:"val",displayField:'name',valueField:'val',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false},{xtype:'combobox',name:'category_id',fieldLabel:'Category',anchor:'100%',store:store_ComboboxProductCategory,queryMode:'local',hiddenName:"id",displayField:'product_category_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false,listConfig:{emptyText:'No Data',minWidth:250,getInnerTpl:function(){return'{product_category_name}';}},pageSize:0},{xtype:'numberfield',name:'normal_price',fieldLabel:'Normal Price',width:250,minValue:0,allowDecimals:true,allowBlank:false,hideTrigger:true,keyNavEnabled:false,mouseWheelEnabled:false},{xtype:'numberfield',name:'product_price',fieldLabel:'Current Price',width:250,minValue:0,allowDecimals:true,allowBlank:false,hideTrigger:true,keyNavEnabled:false,mouseWheelEnabled:false},{xtype:'numberfield',name:'product_hpp',fieldLabel:'HPP',width:250,minValue:0,allowDecimals:true,allowBlank:false,hideTrigger:true,keyNavEnabled:false,mouseWheelEnabled:false},{xtype:'checkbox',name:'is_active',fieldLabel:'Status Active',inputValue:'1',margin:'0 0 10 0'},{xtype:'checkbox',name:'use_tax',fieldLabel:'Use Tax',inputValue:'1',margin:'0 0 10 0'},{xtype:'checkbox',name:'use_service',fieldLabel:'Use Service',inputValue:'1',margin:'0 0 10 0'}]},{xtype:'panel',flex:1,region:'east',layout:{type:'auto'},border:0,bodyPadding:10,items:[{xtype:'displayfield',value:'Product Description'},{xtype:'htmleditor',name:'product_desc',anchor:'100%',height:100,enableColors:false,enableAlignments:false,enableFont:false,enableFontSize:false,enableFormat:true,enableLinks:false,enableLists:false,enableSourceEdit:false,margin:'0 0 10 0'},{xtype:'displayfield',value:'Product Image'},{xtype:'filefield',name:'upload_image',emptyText:'Upload Image, Size Image min 640 (pixel)',msgTarget:'side',width:300,buttonText:'',buttonConfig:{iconCls:'btn-upload'}},{xtype:'image',id:'product_image_src',name:'product_image_src',autoEl:'div',margin:'0 0 5 0'}]}]}]},{title:'Gramasi',id:'product_gramasi_list',bodyPadding:'0 0 0 0',layout:'fit',items:[{xtype:'gridpanel',margins:'0 0 0 0',border:0,region:'center',store:store_masterProductGramasi_masterProduct,id:'grid_masterProductGramasi',scroll:true,selModel:selModel_masterProductGramasi,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'item_id',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'item_name',text:'Item Name',width:150},{xtype:'gridcolumn',dataIndex:'item_category_name',text:'Category',width:150},{xtype:'gridcolumn',dataIndex:'item_qty',text:'QTY',width:80},{xtype:'gridcolumn',dataIndex:'item_price',text:'Price',width:80},{xtype:'gridcolumn',dataIndex:'unit_name',text:'Unit Name',width:120}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_masterProductGramasi').getSelectionModel().selected;if(getSelection.length>0){me.formType_listGramasi='edit';me.edit_data_listGramasi=rec.data;me.createWindow(me,'add_masterProductGramasi');}}},bbar:helperGrid.paging({ds:store_masterProductPackage,title:'Gramasi'}),dockedItems:[{xtype:'toolbar',dock:'top',items:['->',{text:'Add',itemId:'addButton_masterProductGramasi',tooltip:'Add Item Gramasi',iconCls:'btn-add',handler:function(){me.formType_listGramasi='add';me.createWindow(me,'add_masterProductGramasi');}},'-',{text:'Delete',itemId:'deleteButton_masterProductGramasi',tooltip:'Delete Item Gramasi',iconCls:'btn-delete',disabled:true,handler:function(){var getSelection=Ext.getCmp('grid_masterProductGramasi').getSelectionModel().selected;if(getSelection.length>0){me.delete_data_listGramasi=getSelection.items[0].data;me.deleteConfirm_masterProductGramasi();}else{ExtApp.Msg.info('Please Select Item!');}}},'-',{text:'Refresh',itemId:'refreshButton_masterProductGramasi',tooltip:'Refresh Item Gramasi',iconCls:'btn-refresh',handler:function(){Ext.getCmp('grid_masterProductGramasi').store.load();}}]}]}]},{title:'Package List',id:'product_package_list',bodyPadding:'0 0 0 0',layout:'fit',items:[{xtype:'gridpanel',margins:'0 0 0 0',border:0,region:'center',store:store_masterProductPackage,id:'grid_masterProductPackage',scroll:true,selModel:selModel_masterProductPackage,columns:[{xtype:'gridcolumn',dataIndex:'id',text:'ID',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'product_id',hidden:true,hideable:false},{xtype:'gridcolumn',dataIndex:'product_name',text:'Name',width:150},{xtype:'gridcolumn',dataIndex:'product_category_name',text:'Category',width:150},{xtype:'gridcolumn',dataIndex:'product_price',text:'Price',width:80},{xtype:'gridcolumn',dataIndex:'product_hpp',text:'HPP',width:80},{xtype:'gridcolumn',dataIndex:'product_image_show',text:'Image',width:120},{xtype:'gridcolumn',dataIndex:'product_desc',text:'Description',width:200}],viewConfig:{stripeRows:true,forceFit:true},listeners:{itemdblclick:function(view,rec,item,index,eventObj){var getSelection=Ext.getCmp('grid_masterProductPackage').getSelectionModel().selected;if(getSelection.length>0){me.formType_listPackage='edit';me.edit_data_listPackage=rec.data;me.createWindow(me,'add_masterProductPackage');}}},bbar:helperGrid.paging({ds:store_masterProductPackage,title:'List Package'}),dockedItems:[{xtype:'toolbar',dock:'top',items:['->',{text:'Add',itemId:'addButton_masterProductPackage',tooltip:'Add Item Product Package',iconCls:'btn-add',handler:function(){me.formType_listPackage='add';me.createWindow(me,'add_masterProductPackage');}},'-',{text:'Delete',itemId:'deleteButton_masterProductPackage',tooltip:'Delete Item Product Package',iconCls:'btn-delete',disabled:true,handler:function(){var getSelection=Ext.getCmp('grid_masterProductPackage').getSelectionModel().selected;if(getSelection.length>0){me.delete_data_listPackage=getSelection.items[0].data;me.deleteConfirm_masterProductPackage();}else{ExtApp.Msg.info('Please Select Product Package!');}}},'-',{text:'Refresh',itemId:'refreshButton_masterProductPackage',tooltip:'Refresh List Product Package',iconCls:'btn-refresh',handler:function(){Ext.getCmp('grid_masterProductPackage').store.load();}}]}]}]}]},buttons:[{text:'Save',formBind:true,id:'btnSave_masterProduct',iconCls:'btn-save',handler:function(){me.saveConfirm_masterProduct();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_masterProduct');}}],listeners:{show:function(){var form=Ext.getCmp('form_masterProduct').getForm();if(me.formType=='edit'){form.setValues(me.edit_data);Ext.getCmp('product_image_src').setSrc(me.edit_data.product_image_src);form.findField('old_product_type').setValue(me.edit_data.product_type);form.findField('product_group').setValue(me.edit_data.product_group);if(me.edit_data.product_type=='item'){Ext.getCmp('product_package_list').setDisabled(true);Ext.getCmp('product_gramasi_list').setDisabled(false);Ext.getCmp('grid_masterProductPackage').store.loadData([]);Ext.getCmp('grid_masterProductGramasi').store.proxy.extraParams.product_id=me.edit_data.id;Ext.getCmp('grid_masterProductGramasi').store.load();}else{Ext.getCmp('product_package_list').setDisabled(false);Ext.getCmp('product_gramasi_list').setDisabled(true);Ext.getCmp('grid_masterProductPackage').store.proxy.extraParams.package_id=me.edit_data.id;Ext.getCmp('grid_masterProductPackage').store.load();Ext.getCmp('grid_masterProductGramasi').store.loadData([]);}}else{form.reset();form.findField('is_active').setValue(1);form.findField('product_type').setValue('item');Ext.getCmp('product_package_list').setDisabled(true);Ext.getCmp('product_gramasi_list').setDisabled(true);}
store_ComboboxProductCategory.load({callback:function(){if(me.formType=='edit'){form.findField('category_id').select(me.edit_data.category_id);}}});}}});},add_masterProductGramasi:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Add Gramasi Item ';if(me.formType_listGramasi=='edit'){Titletext='Update Gramasi Item: ';}else{me.edit_data_listGramasi=[];}
var store_ComboboxMasterItem_masterProduct=theApp.getStore('store_ComboboxMasterItem_masterProduct',false);if(store_ComboboxMasterItem_masterProduct==false){store_ComboboxMasterItem_masterProduct=theApp.copyStore('master_pos','store_masterItem','store_ComboboxMasterItem_masterProduct');}
store_ComboboxMasterItem_masterProduct.proxy.extraParams.limit=9999;return desktop.createWindow({id:me.id+'_add_masterProductGramasi',title:Titletext,width:450,height:265,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'form',id:'form_masterProductGramasi',border:0,bodyPadding:10,margin:'0 0 0 0',items:[{xtype:'hidden',name:'form_type_masterProductGramasi',value:me.formType_listGramasi},{xtype:'hidden',name:'product_id'},{xtype:'hidden',name:'id'},{xtype:'combobox',name:'item_id',id:'item_id_masterProductGramasi',fieldLabel:'Item',anchor:'100%',labelWidth:120,store:store_ComboboxMasterItem_masterProduct,queryMode:'local',hiddenName:"id",displayField:'item_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false,listConfig:{emptyText:'Tidak ada data',minWidth:250,getInnerTpl:function(){return'{item_name}';}},pageSize:0,listeners:{select:function(combo,records,eOpts){var form=Ext.getCmp('form_masterProductGramasi').getForm();form.findField('item_id').setValue(records[0].data.id);form.findField('unit_name').setValue(records[0].data.unit_name);form.findField('item_category_name').setValue(records[0].data.item_category_name);form.findField('item_price_acuan').setValue(records[0].data.item_price_show);}}},{xtype:'textfield',name:'item_qty',fieldLabel:'Qty',anchor:'100%',labelWidth:120,allowBlank:false},{xtype:'textfield',name:'item_price',fieldLabel:'Harga',anchor:'100%',labelWidth:120,allowBlank:false},{xtype:'displayfield',name:'item_price_acuan',fieldLabel:'Harga Acuan/Unit',anchor:'100%',labelWidth:120,allowBlank:false},{xtype:'displayfield',name:'item_category_name',fieldLabel:'Category',anchor:'100%',labelWidth:120,allowBlank:false},{xtype:'displayfield',name:'unit_name',fieldLabel:'Unit',anchor:'100%',labelWidth:120,allowBlank:false}]}],buttons:[{text:'Save',formBind:true,id:'btnSave_masterProductGramasi',iconCls:'btn-save',handler:function(){me.save_masterProductGramasi();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_masterProductGramasi');}}],listeners:{show:function(){var form=Ext.getCmp('form_masterProductGramasi').getForm();var myMask=new Ext.LoadMask(Ext.getCmp('form_masterProductGramasi'),{msg:"Loading..."});myMask.show();if(me.formType_listGramasi=='edit'){form.setValues(me.edit_data_listGramasi);}else{form.reset();}
form.findField('product_id').setValue(me.edit_data.id);store_ComboboxMasterItem_masterProduct.load({params:{show_choose_text:1},callback:function(records,operation,success){var item_id=0;if(me.formType_listGramasi=='edit'){item_id=me.edit_data_listGramasi.item_id;form.findField('item_id').setValue(me.edit_data_listGramasi.item_id);form.findField('item_price').setValue(me.edit_data_listGramasi.item_price);form.findField('item_qty').setValue(me.edit_data_listGramasi.item_qty);form.findField('item_price_acuan').setValue(me.edit_data_listGramasi.item_price_acuan);form.findField('item_category_name').setValue(me.edit_data_listGramasi.item_category_name);form.findField('unit_name').setValue(me.edit_data_listGramasi.unit_name);form.findField('id').setValue(me.edit_data_listGramasi.id);}
myMask.hide();Ext.getCmp('item_id_masterProductGramasi').select(item_id);}});}}});},add_masterProductPackage:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Add Package Item ';if(me.formType_listPackage=='edit'){Titletext='Update Package Item: ';}
var store_selectProduct_masterProduct=theApp.getStore('master_pos.store_selectProduct_masterProduct');me.store_selectProduct_masterProduct=theApp.getStore('store_selectProduct_masterProduct',false);if(me.store_selectProduct_masterProduct==false){me.store_selectProduct_masterProduct=theApp.copyStore('master_pos','store_masterProduct','store_selectProduct_masterProduct');}
me.store_selectProduct_masterProduct.proxy.extraParams.limit=9999999;me.store_selectProduct_masterProduct.proxy.extraParams.show_all_text=0;me.store_selectProduct_masterProduct.proxy.extraParams.show_choose_text=1;me.store_selectProduct_masterProduct.proxy.extraParams.is_dropdown=1;me.store_selectProduct_masterProduct.proxy.extraParams.keywords='';return desktop.createWindow({id:me.id+'_add_masterProductPackage',title:Titletext,width:350,height:180,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:false,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'form',id:'form_masterProductPackage',border:0,bodyPadding:10,margin:'0 0 0 0',items:[{xtype:'hidden',name:'form_type_masterProductPackage',value:me.formType_listPackage},{xtype:'hidden',name:'package_id'},{xtype:'hidden',name:'id'},{xtype:'combobox',name:'product_id',fieldLabel:'Product',anchor:'100%',store:store_selectProduct_masterProduct,queryMode:'local',hiddenName:"id",displayField:'product_name',valueField:'id',typeAhead:true,minChars:1,forceSelection:true,allowBlank:false,listConfig:{emptyText:'Tidak ada data',minWidth:250,getInnerTpl:function(){return'{product_name}';}},pageSize:0,listeners:{select:function(combo,records,eOpts){var form=Ext.getCmp('form_masterProductPackage').getForm();form.findField('product_price').setValue(records[0].data.product_price);form.findField('product_hpp').setValue(records[0].data.product_hpp);}}},{xtype:'textfield',name:'product_price',fieldLabel:'Price',anchor:'100%',allowBlank:false},{xtype:'textfield',name:'product_hpp',fieldLabel:'HPP',anchor:'100%',allowBlank:false}]}],buttons:[{text:'Save',formBind:true,id:'btnSave_masterProductPackage',iconCls:'btn-save',handler:function(){me.save_masterProductPackage();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_masterProductPackage');}}],listeners:{show:function(){var form=Ext.getCmp('form_masterProductPackage').getForm();var myMask=new Ext.LoadMask(Ext.getCmp('form_masterProductPackage'),{msg:"Loading..."});myMask.show();if(me.formType_listPackage=='edit'){form.setValues(me.edit_data_listPackage);}else{form.reset();}
form.findField('package_id').setValue(me.edit_data.id);store_selectProduct_masterProduct.load({params:{package_id:me.edit_data.id,show_choose_text:1},callback:function(records,operation,success){var product_id=0;if(me.formType_listPackage=='edit'){product_id=me.edit_data_listPackage.product_id;}
form.findField('product_id').setValue(product_id);myMask.hide();}});}}});},add_uploadMasterProduct:function(me){var theApp=me.app;var desktop=theApp.getDesktop();var Titletext='Upload Product/Menus ';if(me.formType=='edit'){Titletext='Upload Product/Menus: ';}
var helperGrid=theApp.getHelper('Grid');var phpJs=theApp.getHelper('phpJs');return desktop.createWindow({id:me.id+'_add_uploadMasterProduct',title:Titletext,width:370,height:170,iconCls:'btn-add',animCollapse:false,constrainHeader:true,resizable:true,minimizable:false,maximizable:false,modal:true,border:0,layout:{type:'fit'},items:[{xtype:'form',id:'form_uploadMasterProduct',border:0,bodyPadding:10,margin:'0 0 0 0',labelWidth:100,items:[{xtype:'filefield',name:'upload_file',emptyText:'Excel (.xls)',fieldLabel:'File Product/Menus ',margin:'5 0 15 0',width:300,buttonText:'',buttonConfig:{iconCls:'btn-upload'}}]}],buttons:[{text:'Save',formBind:true,id:'btnSave_uploadMasterProduct',iconCls:'btn-save',handler:function(){me.save_uploadMasterProduct();}},{text:'Cancel',iconCls:'btn-cancel',handler:function(){me.doClose(me.id+'_add_uploadMasterProduct');}}],listeners:{show:function(){}}});}});